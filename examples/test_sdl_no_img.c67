import libc as c
import sdl3 as sdl

width = 620
height = 387

// Skip SDL_Init error check for now since it returns 1 but works
sdl.SDL_Init(32)

window = sdl.SDL_CreateWindow("Hello World!", width, height, 0)
renderer = sdl.SDL_CreateRenderer(window, 0)

println("Setup complete, starting event loop...")

running = 1
event = c.malloc(192)

@ running > 0 max inf {
    has_event = sdl.SDL_PollEvent(event)
    
    has_event {
        0 => {}
        ~> { running = 0 }
    }

    sdl.SDL_SetRenderDrawColor(renderer, 0, 100, 200, 255)
    sdl.SDL_RenderClear(renderer)
    sdl.SDL_RenderPresent(renderer)
    sdl.SDL_Delay(16)
}

c.free(event)
sdl.SDL_DestroyRenderer(renderer)
sdl.SDL_DestroyWindow(window)
sdl.SDL_Quit()

println("Done!")
