import sdl3 as sdl

cstruct SDL_Event {
    type as uint32,
    timestamp as uint64
}

sdl.SDL_Init(sdl.SDL_INIT_VIDEO) or! {
    exitf("SDL_Init failed\n")
}

window = sdl.SDL_CreateWindow("Test", 640, 480, 0) or! {
    exitf("Failed to create window\n")
}

event := (c.malloc(192) as SDL_Event)
printf("Event allocated at: %p\n", event)
printf("Testing SDL_PollEvent...\n")

result := sdl.SDL_PollEvent(event)
printf("SDL_PollEvent returned: %d\n", result)
printf("Event type: %d\n", event.type)

c.free(event)
sdl.SDL_DestroyWindow(window)
sdl.SDL_Quit()
